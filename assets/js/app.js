"use strict";document.addEventListener("DOMContentLoaded",function(){PubSub.publish("init");for(var e=document.getElementById("close-nav"),t=document.querySelector(".main-nav"),i=document.querySelector(".nav-button"),n=document.querySelectorAll(".main-nav__item"),s="",r=0,o=n.length;r<o;r++)n[r].addEventListener("click",function(e){e.preventDefault(),s=e.target.getAttribute("href").slice(1),t.classList.remove("main-nav_active"),window.scrollTo(0,document.getElementById(s).offsetTop)});e.addEventListener("click",function(){t.classList.remove("main-nav_active")}),i.addEventListener("click",function(){t.classList.add("main-nav_active")});var l=document.querySelectorAll(".button-order"),c=document.querySelector(".order-modal"),a=document.querySelectorAll(".close");for(r=0;r<l.length;r++)l[r].addEventListener("click",function(e){e.preventDefault(c),c.classList.add("visible")});for(r=0;r<a.length;r++)a[r].addEventListener("click",function(){this.parentNode.parentNode.classList.remove("visible")});var d=document.querySelectorAll(".rewiews__detil");for(r=0;r<d.length;r++)d[r].addEventListener("click",function(){for(var e=document.querySelectorAll(".abs"),t=0;t<e.length;t++)e[t].classList.remove("abs--active");this.children[0].classList.add("abs--active")});(function(){function e(e){e.stopPropagation(),t.paused?(t.play(),i.innerHTML=""):(t.pause(),i.innerHTML="")}var t=document.querySelector("video"),i=document.querySelector(".staff__video-play");i.addEventListener("click",e),t.addEventListener("click",e)})(),function(){for(var e=document.querySelectorAll(".questions__item"),t=document.querySelectorAll(".questions__answers"),i=0,n=e.length;i<n;i++)e[i].addEventListener("click",function(){if(!this.children[0].classList.contains("questions__text--active"))for(var i=0;i<e.length;i++)e[i].children[0].classList.remove("questions__text--active"),t[i].classList.remove("questions__answers--active");this.children[0].classList.toggle("questions__text--active"),this.children[1].classList.toggle("questions__answers--active")})}()});var Counter=function(){function e(e){var t=document.querySelector("#days"),i=document.querySelector("#minutes"),n=document.querySelector("#hours"),s=document.querySelector("#sec"),r=function(e){return{days:Math.floor(e/864e5),hours:Math.floor(e%864e5/36e5),minutes:Math.floor(e%864e5%36e5/6e4),sec:Math.floor(e%864e5%36e5%6e4/1e3)}}(e),o=function(e,t){t.textContent=e<10?"0"+e:e};o(r.sec,s),o(r.minutes,i),o(r.hours,n),o(r.days,t)}var t;PubSub.subscribe("init",function(){var i=new Date,n=new Date(2017,11,20),s=n-i;t=setInterval(function(){(s=Math.round(n-Date.now()))<0?clearInterval(t):e(s)},1e3)})}(),Calc=function(){var e=document.querySelectorAll(".calc-button")[0],t=document.querySelectorAll(".calc-modal")[0],i=document.querySelectorAll(".slideValue"),n=document.querySelectorAll(".slider"),s=n[0].value,r=document.querySelectorAll(".rooms-count__item--active")[0],o=document.querySelectorAll(".price-offers__item--active")[0],l=document.querySelectorAll(".rooms-count__item"),c=document.querySelectorAll(".price-offers__item");n[0].addEventListener("input",function(){s=n[0].value,i[0].innerHTML=s+" м <sup>2</sup>"});for(var a=0;a<l.length;a++)l[a].addEventListener("click",function(){for(var e=0;e<l.length;e++)l[e].classList.remove("rooms-count__item--active");this.classList.add("rooms-count__item--active"),r=document.querySelectorAll(".rooms-count__item--active")[0]});for(a=0;a<c.length;a++)c[a].addEventListener("click",function(){for(var e=0;e<c.length;e++)c[e].classList.remove("price-offers__item--active");this.classList.add("price-offers__item--active"),o=document.querySelectorAll(".price-offers__item--active")[0]});PubSub.subscribe("init",function(){e.addEventListener("click",function(e){e.preventDefault(),document.querySelectorAll(".calc-modal__rooms")[0].innerHTML=r.innerHTML,document.querySelectorAll(".calc-modal__repair")[0].innerHTML=o.children[1].innerHTML.split(" ")[0],document.querySelectorAll(".calc-modal__sq")[0].innerHTML=s+" м <sup>2</sup>",document.querySelector(".calc-modal__cost").innerHTML=o.children[0].innerHTML,t.classList.add("visible")})})}(),Modal=function(){function e(e){e.preventDefault;var t=e.target.parentNode,i=t.querySelector(".services__text").innerHTML,s=t.querySelector(".services__title").innerHTML;n.querySelector(".more-modal__text").innerHTML=i,n.querySelector(".more-modal__title").innerHTML=s,n.classList.add("visible")}var t=document,i=t.querySelectorAll(".services__more-button"),n=t.querySelector(".more-modal");PubSub.subscribe("init",function(){for(var t=0;t<i.length;t++)i[t].addEventListener("click",e)})}(),Slider=function(e){var t=0,i=this;this.sliderShow=document.querySelector(e),this.sliderShowItems=this.sliderShow.querySelectorAll(".slider-show__item"),this.arrowLeft=this.sliderShow.querySelector(".arrow-left"),this.arrowRight=this.sliderShow.querySelector(".arrow-right"),this.pagination=this.sliderShow.querySelector(".slider-show__pagination"),this.paginationItems=[],this.createPagination=function(e){for(var t,i=this.sliderShowItems.length,n=document.createDocumentFragment(),s=0;s<i;s++)(t=document.createElement("div")).className="slider-show__pagination-item",0==s&&t.classList.add("slider-show__pagination-item--active"),n.appendChild(t);this.pagination.innerHTML="",this.pagination.appendChild(n)},this.clickPagination=function(e){i.reset(),e.target.classList.add("page-pagination__item--active");for(var n=0;n<i.pagintonItems.length;n++)i.pagintonItems[n]==e.target&&(t=n);i.sliderShowItems[t].classList.add("slider__item_active"),i.pagintonItems[t].classList.add("slider-show__pagination-item--active")},this.reset=function(){for(var e=0,t=this.sliderShowItems.length;e<t;e++)this.sliderShowItems[e].classList.remove("slider__item_active"),this.pagintonItems[e].classList.remove("slider-show__pagination-item--active")},this.startSlide=function(t){this.createPagination(e),this.pagintonItems=this.pagination.querySelectorAll(".slider-show__pagination-item"),this.reset(),this.sliderShowItems[t].classList.add("slider__item_active"),this.pagintonItems[t].classList.add("slider-show__pagination-item--active"),this.init()},this.slideLeft=function(){this.reset(),this.sliderShowItems[t-1].classList.add("slider__item_active"),this.pagintonItems[t-1].classList.add("slider-show__pagination-item--active"),t--},this.slideRight=function(){this.reset(),this.sliderShowItems[t+1].classList.add("slider__item_active"),this.pagintonItems[t+1].classList.add("slider-show__pagination-item--active"),t++},this.init=function(){for(var e=0,n=this.pagintonItems.length;e<n;e++)this.pagintonItems[e].addEventListener("click",this.clickPagination);this.arrowLeft.addEventListener("click",function(){0===t&&(t=i.sliderShowItems.length),i.slideLeft()}),this.arrowRight.addEventListener("click",function(){t===i.sliderShowItems.length-1&&(t=-1),i.slideRight()})}},sliderForPortfolio=function(){function e(e){e.preventDefault();var t,i,s=this.dataset.img;if(s){l.style.display="block",c.style.display="block",s=s.split(","),i=document.createDocumentFragment();for(var a=0;a<s.length;a++)(t=document.createElement("li")).innerHTML='<div class = "slider-show__content"><img src = "assets/img/'+s[a]+'"></div>',t.className="slider-show__item",i.appendChild(t);o.innerHTML="",o.appendChild(i);new Slider(".slider-show--img").startSlide(0)}else l.style.display="none",c.style.display="none",r.innerHTML="",o.innerHTML="",o.innerHTML='<p style = "margin: auto;">Нет информации по данному объекту</p>';n.classList.add("visible")}for(var t=document.querySelectorAll(".portfolio__item"),i=document.querySelectorAll(".open-slider"),n=(t.length,document.querySelector(".show-photos-modal")),s=document.querySelector(".slider-show--img"),r=s.querySelector(".slider-show__pagination"),o=document.querySelector(".slider-show__list"),l=s.querySelector(".arrow-left"),c=s.querySelector(".arrow-right"),a=0;a<t.length;a++)t[a].addEventListener("click",e),i[a].addEventListener("click",e)}(),rewiewSlider=void new Slider(".slider-show_rew").startSlide(0);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvdW50ZXIuanMiLCJjYWxjLmpzIiwibW9yZU1vZGFsLmpzIiwic2xpZGVyQ29uc3RydWN0b3IuanMiLCJwb3J0Zm9saW9IYW5kbGVyLmpzIiwic2xpZGVyRm9yUmV3aWV3cy5qcyJdLCJuYW1lcyI6WyJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJQdWJTdWIiLCJwdWJsaXNoIiwiYnV0dG9uQ2xvc2VOYXYiLCJnZXRFbGVtZW50QnlJZCIsInNpZGVOYXYiLCJxdWVyeVNlbGVjdG9yIiwiYnV0dG9uT3Blbk5hdiIsIm1haW5OYXZJdGVtcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpZFNlYyIsImkiLCJtYXgiLCJsZW5ndGgiLCJlIiwicHJldmVudERlZmF1bHQiLCJ0YXJnZXQiLCJnZXRBdHRyaWJ1dGUiLCJzbGljZSIsImNsYXNzTGlzdCIsInJlbW92ZSIsIndpbmRvdyIsInNjcm9sbFRvIiwib2Zmc2V0VG9wIiwiYWRkIiwib3JkZXJCdXR0b25zIiwib3JkZXJXaW5kb3ciLCJjbG9zZUJ1dHRvbiIsInRoaXMiLCJwYXJlbnROb2RlIiwiZGV0YWlsQnV0dG9ucyIsImFicyIsImoiLCJjaGlsZHJlbiIsImNsaWNrVmlkZW8iLCJzdG9wUHJvcGFnYXRpb24iLCJ2aWRlbyIsInBhdXNlZCIsInBsYXkiLCJwbGF5UGF1c2VCdXR0b24iLCJpbm5lckhUTUwiLCJwYXVzZSIsInF1ZXN0aW9ucyIsImFuc3dlcnMiLCJjb250YWlucyIsInRvZ2dsZSIsIkNvdW50ZXIiLCJkaXNwbGF5VGltZSIsInNlY29uZExlZnQiLCJkYXlzQ29udGFpbmVyIiwibWludXRlc0NvbnRhaW5lciIsImhvdXJzQ29udGFpbmVyIiwic2VjQ29udGFpbmVyIiwidGltZUxlZnQiLCJtcyIsImRheXMiLCJNYXRoIiwiZmxvb3IiLCJob3VycyIsIm1pbnV0ZXMiLCJzZWMiLCJ0cmFuc2Zvcm1UaW1lIiwiY29ycmVjdFRpbWUiLCJ0aW1lRm9yQ29ycmVjdGlvbiIsImNvbnRhaW5lciIsInRleHRDb250ZW50IiwiY291bnRkb3duIiwic3Vic2NyaWJlIiwibm93IiwiRGF0ZSIsInRoZW4iLCJzZXRJbnRlcnZhbCIsInJvdW5kIiwiY2xlYXJJbnRlcnZhbCIsIkNhbGMiLCJjYWxjQnV0dG9uIiwiY2FsY1dpbmRvdyIsInNsaWRlVmFsdWUiLCJzbGlkZXIiLCJmbGF0U3EiLCJ2YWx1ZSIsImZsYXRUeXBlIiwicmVwYWlyVHlwZSIsImNoZWNrRmxhdFR5cGUiLCJjaGVja1JlcGFpclR5cGUiLCJzcGxpdCIsIk1vZGFsIiwic2hvd0Z1bGxUZXh0Iiwic2VydmljZUl0ZW0iLCJzZXJ2aWNlSXRlbVRleHQiLCJzZXJ2aWNlSXRlbVRpdGxlIiwibW9kYWxXaW5kb3ciLCJkb2NPYmoiLCJtb3JlQnV0dG9ucyIsIlNsaWRlciIsInNsaWRlckNsYXNzIiwiY3VycmVudFNsaWRlIiwic2VsZiIsInNsaWRlclNob3ciLCJzbGlkZXJTaG93SXRlbXMiLCJhcnJvd0xlZnQiLCJhcnJvd1JpZ2h0IiwicGFnaW5hdGlvbiIsInBhZ2luYXRpb25JdGVtcyIsImNyZWF0ZVBhZ2luYXRpb24iLCJzbGlkZXJOYW1lIiwicGFnaW5hdGlvbkl0ZW0iLCJzbGlkZXJFbGVtZW50c0NvdW50IiwiZnJhZ21lbnRPZlBhZ2luYXRpb25zIiwiY3JlYXRlRG9jdW1lbnRGcmFnbWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJhcHBlbmRDaGlsZCIsImNsaWNrUGFnaW5hdGlvbiIsInJlc2V0IiwicGFnaW50b25JdGVtcyIsInN0YXJ0U2xpZGUiLCJpbml0Iiwic2xpZGVMZWZ0Iiwic2xpZGVSaWdodCIsInNsaWRlckZvclBvcnRmb2xpbyIsImdldEltYWdlcyIsInNsaWRlIiwiZnJhZ21lbnRPZlNsaWRlcyIsImltYWdlcyIsImRhdGFzZXQiLCJpbWciLCJzdHlsZSIsImRpc3BsYXkiLCJzbGlkZXJTaG93TGlzdCIsInNsaWRlcldpbmRvdyIsInBvcnRmb2xpb0l0ZW1zIiwicG9ydGZvbGlvQnV0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c0JBQ0E4RixFQUFBaUMsRUFBQS9ILGNBQUEsZUFDQStGLEVBQUFnQyxFQUFBL0gsY0FBQSxnQkFFQUssRUFBQSxFQUFBQSxFQUFBd0gsRUFBQXRILE9BQUFGLElBQ0F3SCxFQUFBeEgsR0FBQVgsaUJBQUEsUUFBQXlILEdBQ0FXLEVBQUF6SCxHQUFBWCxpQkFBQSxRQUFBeUgsR0FqQkEsR0NBQWEsa0JBRUEsSUFBQXhDLE9BQUEsb0JBQ0FzQixXQUFBIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGZ1bmN0aW9uKCl7XHJcbiAgXHJcbiAgUHViU3ViLnB1Ymxpc2goICdpbml0Jyk7XHJcblxyXG4gIC8vINC30LDQutGA0YvRgtGML9C+0YLQutGA0YvRgtGMINC90LDQstC40LPQsNGG0LjRjlxyXG5cclxuICB2YXIgYnV0dG9uQ2xvc2VOYXYgID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nsb3NlLW5hdicpLFxyXG4gICAgICBzaWRlTmF2ICAgICAgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWFpbi1uYXYnKSxcclxuICAgICAgYnV0dG9uT3Blbk5hdiAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5hdi1idXR0b24nKSxcclxuICAgICAgbWFpbk5hdkl0ZW1zICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1haW4tbmF2X19pdGVtJyksXHJcbiAgICAgIGlkU2VjID0gJyc7XHJcblxyXG4gIGZvciAodmFyIGkgPSAwLCBtYXggPSBtYWluTmF2SXRlbXMubGVuZ3RoOyBpIDwgbWF4OyBpKyspIHtcclxuICAgIG1haW5OYXZJdGVtc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpe1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgaWRTZWMgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2hyZWYnKS5zbGljZSgxKTtcclxuICAgICAgICBzaWRlTmF2LmNsYXNzTGlzdC5yZW1vdmUoJ21haW4tbmF2X2FjdGl2ZScpO1xyXG4gICAgICAgIHdpbmRvdy5zY3JvbGxUbygwLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZFNlYykub2Zmc2V0VG9wKTtcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBidXR0b25DbG9zZU5hdi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgc2lkZU5hdi5jbGFzc0xpc3QucmVtb3ZlKCdtYWluLW5hdl9hY3RpdmUnKTtcclxuICB9KTtcclxuXHJcbiAgYnV0dG9uT3Blbk5hdi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgc2lkZU5hdi5jbGFzc0xpc3QuYWRkKCdtYWluLW5hdl9hY3RpdmUnKTtcclxuICB9KTtcclxuXHJcbi8vINC+0YLQutGA0YvRgtC40LUg0Lgg0LfQsNC60YDRi9GC0LjQtSDQvNC+0LTQsNC70YzQvdC+0LPQviDQvtC60L3QsFxyXG4gIHZhciBvcmRlckJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnV0dG9uLW9yZGVyJyksIFxyXG4gICAgICBvcmRlcldpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5vcmRlci1tb2RhbCcpLFxyXG4gICAgICBjbG9zZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jbG9zZScpO1xyXG4gICAgICBcclxuXHJcbiAgXHJcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBvcmRlckJ1dHRvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgIG9yZGVyQnV0dG9uc1tpXS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZSl7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQob3JkZXJXaW5kb3cpO1xyXG4gICAgICBvcmRlcldpbmRvdy5jbGFzc0xpc3QuYWRkKCd2aXNpYmxlJyk7XHJcbiAgICB9KVxyXG4gIH07XHJcbiAgXHJcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBjbG9zZUJ1dHRvbi5sZW5ndGg7IGkrKykge1xyXG4gICAgY2xvc2VCdXR0b25baV0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICB0aGlzLnBhcmVudE5vZGUucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKCd2aXNpYmxlJyk7XHJcbiAgICB9KVxyXG4gIH07XHJcbiBcclxuXHJcbiAgXHJcblxyXG5cclxuXHJcbiAgdmFyIGRldGFpbEJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucmV3aWV3c19fZGV0aWwnKTtcclxuICAgIFxyXG4gIGZvcih2YXIgaT0wOyBpPGRldGFpbEJ1dHRvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgIFxyXG4gICAgZGV0YWlsQnV0dG9uc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgIHZhciBhYnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYWJzJyk7XHJcbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGFicy5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICBhYnNbal0uY2xhc3NMaXN0LnJlbW92ZSgnYWJzLS1hY3RpdmUnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHRoaXMuY2hpbGRyZW5bMF0uY2xhc3NMaXN0LmFkZCgnYWJzLS1hY3RpdmUnKTtcclxuICAgICAgICB9KVxyXG4gICAgICB9XHJcbiAgICBcclxuLy8g0JTQu9GPINCy0LjQtNC10L5cclxuICAgICAgdmFyIHZpZGVvSGFuZGxlciA9IChmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgdmlkZW8gICAgICAgICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigndmlkZW8nKSxcclxuICAgICAgICAgICAgcGxheVBhdXNlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnN0YWZmX192aWRlby1wbGF5Jyk7XHJcbiAgICBcclxuICAgICAgICBmdW5jdGlvbiBjbGlja1ZpZGVvKGUpIHtcclxuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICBpZiAodmlkZW8ucGF1c2VkKSB7XHJcbiAgICAgICAgICAgIHZpZGVvLnBsYXkoKTtcclxuICAgICAgICAgICAgcGxheVBhdXNlQnV0dG9uLmlubmVySFRNTCA9ICfviownO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdmlkZW8ucGF1c2UoKTtcclxuICAgICAgICAgICAgcGxheVBhdXNlQnV0dG9uLmlubmVySFRNTCA9ICfvgJ0nO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBwbGF5UGF1c2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbGlja1ZpZGVvKTtcclxuICAgICAgICB2aWRlby5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsaWNrVmlkZW8pO1xyXG4gICAgXHJcbiAgICB9KSgpO1xyXG4vLyDQodC10LrRhtC40Y8g0LLQvtC/0YDQvtGB0YtcclxudmFyIHF1ZXN0aW9uc0hhbmRsZXIgPSAoZnVuY3Rpb24oKSB7XHJcblxyXG4gIHZhciBxdWVzdGlvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucXVlc3Rpb25zX19pdGVtJyksXHJcbiAgICAgIGFuc3dlcnMgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucXVlc3Rpb25zX19hbnN3ZXJzJyk7XHJcblxyXG4gIGZvcih2YXIgaT0wLCBtYXggPSBxdWVzdGlvbnMubGVuZ3RoOyBpIDwgbWF4OyBpKyspIHtcclxuXHJcbiAgICBxdWVzdGlvbnNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgXHJcbiAgICAgIGlmICghKHRoaXMuY2hpbGRyZW5bMF0uY2xhc3NMaXN0LmNvbnRhaW5zKCdxdWVzdGlvbnNfX3RleHQtLWFjdGl2ZScpKSkge1xyXG4gICAgICAgIGZvcih2YXIgaiA9IDA7IGogPCBxdWVzdGlvbnMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgIHF1ZXN0aW9uc1tqXS5jaGlsZHJlblswXS5jbGFzc0xpc3QucmVtb3ZlKCdxdWVzdGlvbnNfX3RleHQtLWFjdGl2ZScpO1xyXG4gICAgICAgICAgYW5zd2Vyc1tqXS5jbGFzc0xpc3QucmVtb3ZlKCdxdWVzdGlvbnNfX2Fuc3dlcnMtLWFjdGl2ZScpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICB0aGlzLmNoaWxkcmVuWzBdLmNsYXNzTGlzdC50b2dnbGUoJ3F1ZXN0aW9uc19fdGV4dC0tYWN0aXZlJyk7XHJcbiAgICAgIHRoaXMuY2hpbGRyZW5bMV0uY2xhc3NMaXN0LnRvZ2dsZSgncXVlc3Rpb25zX19hbnN3ZXJzLS1hY3RpdmUnKTtcclxuICAgICAgfSlcclxuICAgIH1cclxuICB9KSgpO1xyXG5cclxufSk7IiwidmFyIENvdW50ZXIgPSAoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgdmFyIGNvdW50ZG93bjtcclxuXHJcbiAgICBmdW5jdGlvbiB0cmFuc2Zvcm1UaW1lKG1zKSB7XHJcblxyXG4gICAgICAgIHZhciBkYXlMZWZ0ICAgICA9ICBNYXRoLmZsb29yKG1zLzg2NDAwMDAwKSxcclxuICAgICAgICAgICAgaG91cnNMZWZ0ICAgPSAgTWF0aC5mbG9vcigobXMlODY0MDAwMDApLzM2MDAwMDApLFxyXG4gICAgICAgICAgICBtaW5MZWZ0ICAgICA9ICBNYXRoLmZsb29yKCgobXMlODY0MDAwMDApJTM2MDAwMDApLzYwMDAwKSxcclxuICAgICAgICAgICAgc2VjTGVmdCAgICAgPSAgTWF0aC5mbG9vcigoKChtcyU4NjQwMDAwMCklMzYwMDAwMCklNjAwMDApLzEwMDApO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBkYXlzOiBkYXlMZWZ0LFxyXG4gICAgICAgICAgICBob3VyczogaG91cnNMZWZ0LFxyXG4gICAgICAgICAgICBtaW51dGVzOiBtaW5MZWZ0LFxyXG4gICAgICAgICAgICBzZWM6ICAgc2VjTGVmdFxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgZnVuY3Rpb24gZGlzcGxheVRpbWUoc2Vjb25kTGVmdCkge1xyXG5cclxuICAgICAgICB2YXIgZGF5c0NvbnRhaW5lciAgICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNkYXlzJyksXHJcbiAgICAgICAgICAgIG1pbnV0ZXNDb250YWluZXIgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWludXRlcycpLFxyXG4gICAgICAgICAgICBob3Vyc0NvbnRhaW5lciAgICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2hvdXJzJyksXHJcbiAgICAgICAgICAgIHNlY0NvbnRhaW5lciAgICAgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc2VjJyksXHJcblxyXG4gICAgICAgICAgICB0aW1lTGVmdCAgICAgICAgICAgID0gdHJhbnNmb3JtVGltZShzZWNvbmRMZWZ0KTtcclxuXHJcbiAgICAgICAgLy8g0KTRg9C90LrRhtC40Y8g0LTQu9GPINC60L7RgNGA0LXQutGG0LjQuCDQstGA0LXQvNC10L3QuCAo0LrQs9C00LAg0LLRi9Cy0L7QtNC40Lwg0LIg0LTQuNCyLCDQtNC+0LHQsNCy0LvRj9C10Lwg0L3QvtC70Ywg0LLQv9C10YDQtdC00LgsINC10YHQu9C4INC80LXQvdGM0YjQtSAxMClcclxuICAgICAgICB2YXIgY29ycmVjdFRpbWUgPSBmdW5jdGlvbih0aW1lRm9yQ29ycmVjdGlvbiwgY29udGFpbmVyKSB7XHJcbiAgICAgICAgICAgIGlmICh0aW1lRm9yQ29ycmVjdGlvbiA8IDEwKSB7XHJcbiAgICAgICAgICAgICAgICBjb250YWluZXIudGV4dENvbnRlbnQgPSAnMCcgKyB0aW1lRm9yQ29ycmVjdGlvbjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgY29udGFpbmVyLnRleHRDb250ZW50ID0gdGltZUZvckNvcnJlY3Rpb247XHJcbiAgICAgICAgICAgIH0gXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvcnJlY3RUaW1lKHRpbWVMZWZ0LnNlYywgc2VjQ29udGFpbmVyICk7XHJcbiAgICAgICAgY29ycmVjdFRpbWUodGltZUxlZnQubWludXRlcywgbWludXRlc0NvbnRhaW5lciApO1xyXG4gICAgICAgIGNvcnJlY3RUaW1lKHRpbWVMZWZ0LmhvdXJzLCBob3Vyc0NvbnRhaW5lciApO1xyXG4gICAgICAgIGNvcnJlY3RUaW1lKHRpbWVMZWZ0LmRheXMsIGRheXNDb250YWluZXIgKTtcclxuICAgIH07XHJcbiAgXHJcbiAgICAvLyDQodGC0LDRgNGCINGC0LDQudC80LXRgNCwXHJcbiAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpLFxyXG4gICAgICAgICAgICB0aGVuID0gbmV3IERhdGUgKDIwMTcsIDExLCAyMCksXHJcbiAgICAgICAgICAgIHNlY29uZExlZnQgPSB0aGVuIC1ub3c7XHJcblxyXG4gICAgICAgIGNvdW50ZG93biA9IHNldEludGVydmFsKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBzZWNvbmRMZWZ0ID0gTWF0aC5yb3VuZCgodGhlbiAtIERhdGUubm93KCkpKTtcclxuICAgICAgICAgICAgaWYoc2Vjb25kTGVmdCA8IDApIHtcclxuICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoY291bnRkb3duKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBkaXNwbGF5VGltZShzZWNvbmRMZWZ0KVxyXG4gICAgICAgICAgfSwxMDAwKTtcclxuICAgIH07XHJcblxyXG4vLyDQn9C+0LTQv9C40YHRi9Cy0LDQtdC80YHRjyDQvdCwINGB0L7QsdC40YLQuNC1INC30LDQs9GA0YPQt9C60Lgg0YHRgtGA0LDQvdC40YbRi1xyXG5QdWJTdWIuc3Vic2NyaWJlKCAnaW5pdCcsIGluaXQgKTtcclxuXHJcbn0pKCk7IiwidmFyIENhbGMgPSAoZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgdmFyIGNhbGNCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2FsYy1idXR0b24nKVswXSxcclxuICAgICAgICBjYWxjV2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNhbGMtbW9kYWwnKVswXSxcclxuXHJcbiAgICAgICAgc2xpZGVWYWx1ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zbGlkZVZhbHVlJyksXHJcbiAgICAgICAgc2xpZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNsaWRlcicpLFxyXG5cclxuICAgICAgICBmbGF0U3EgPSBzbGlkZXJbMF0udmFsdWUsXHJcbiAgICAgICAgZmxhdFR5cGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucm9vbXMtY291bnRfX2l0ZW0tLWFjdGl2ZScpWzBdLFxyXG4gICAgICAgIHJlcGFpclR5cGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucHJpY2Utb2ZmZXJzX19pdGVtLS1hY3RpdmUnKVswXSxcclxuXHJcbiAgICAgICAgY2hlY2tGbGF0VHlwZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5yb29tcy1jb3VudF9faXRlbScpLFxyXG4gICAgICAgIGNoZWNrUmVwYWlyVHlwZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wcmljZS1vZmZlcnNfX2l0ZW0nKTtcclxuXHJcbiAgICAgICAgIC8vINC40LfQvNC10L3Rj9C10Lwg0L/Qu9C+0YnQsNC00Ywg0LrQstCw0YDRgtC40YDRi1xyXG4gICAgICAgIHNsaWRlclswXS5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgZmxhdFNxID0gc2xpZGVyWzBdLnZhbHVlO1xyXG4gICAgICAgICAgICBzbGlkZVZhbHVlWzBdLmlubmVySFRNTCA9IGZsYXRTcSArICcg0LwgPHN1cD4yPC9zdXA+JztcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICAvLyDQv9C+0LvRg9GH0LDQtdC8INC60L7Qu9C40YfQtdGB0YLQstC+INC60L7QvNC90LDRglxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hlY2tGbGF0VHlwZS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBjaGVja0ZsYXRUeXBlW2ldLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGNoZWNrRmxhdFR5cGUubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgICAgIGNoZWNrRmxhdFR5cGVbal0uY2xhc3NMaXN0LnJlbW92ZSgncm9vbXMtY291bnRfX2l0ZW0tLWFjdGl2ZScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuY2xhc3NMaXN0LmFkZCgncm9vbXMtY291bnRfX2l0ZW0tLWFjdGl2ZScpO1xyXG4gICAgICAgICAgICBmbGF0VHlwZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5yb29tcy1jb3VudF9faXRlbS0tYWN0aXZlJylbMF07IFxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vINC/0L7Qu9GD0YfQsNC10Lwg0YLQuNC/INGA0LXQvNC+0L3RgtCwXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGVja1JlcGFpclR5cGUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgY2hlY2tSZXBhaXJUeXBlW2ldLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGNoZWNrUmVwYWlyVHlwZS5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICAgICAgY2hlY2tSZXBhaXJUeXBlW2pdLmNsYXNzTGlzdC5yZW1vdmUoJ3ByaWNlLW9mZmVyc19faXRlbS0tYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLmNsYXNzTGlzdC5hZGQoJ3ByaWNlLW9mZmVyc19faXRlbS0tYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIHJlcGFpclR5cGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucHJpY2Utb2ZmZXJzX19pdGVtLS1hY3RpdmUnKVswXTsgXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICBmdW5jdGlvbiBpbml0KCkge1xyXG4gICAgICAgIGNhbGNCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKGUpe1xyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jYWxjLW1vZGFsX19yb29tcycpWzBdLmlubmVySFRNTCA9IGZsYXRUeXBlLmlubmVySFRNTDtcclxuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNhbGMtbW9kYWxfX3JlcGFpcicpWzBdLmlubmVySFRNTCA9IHJlcGFpclR5cGUuY2hpbGRyZW5bMV0uaW5uZXJIVE1MLnNwbGl0KFwiIFwiKVswXTtcclxuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNhbGMtbW9kYWxfX3NxJylbMF0uaW5uZXJIVE1MID0gZmxhdFNxICsgJyDQvCA8c3VwPjI8L3N1cD4nO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2FsYy1tb2RhbF9fY29zdCcpLmlubmVySFRNTCA9IHJlcGFpclR5cGUuY2hpbGRyZW5bMF0uaW5uZXJIVE1MO1xyXG4gICAgICAgICAgICBjYWxjV2luZG93LmNsYXNzTGlzdC5hZGQoJ3Zpc2libGUnKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9ICBcclxuICAgICAgdmFyIHRva2VuID0gUHViU3ViLnN1YnNjcmliZSggJ2luaXQnLCBpbml0ICk7XHJcbiAgXHJcbn0pKCk7IiwidmFyIE1vZGFsID0gKGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIGRvY09iaiAgICAgICAgICA9IGRvY3VtZW50LFxyXG4gICAgICAgIG1vcmVCdXR0b25zICAgICA9IGRvY09iai5xdWVyeVNlbGVjdG9yQWxsKCcuc2VydmljZXNfX21vcmUtYnV0dG9uJyksXHJcbiAgICAgICAgbW9kYWxXaW5kb3cgICAgID0gZG9jT2JqLnF1ZXJ5U2VsZWN0b3IoJy5tb3JlLW1vZGFsJyk7XHJcbiAgICAgICAgICBcclxuICAgICAgICBmdW5jdGlvbiBzaG93RnVsbFRleHQoZSkge1xyXG5cclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdDtcclxuXHJcbiAgICAgICAgICAgIHZhciBzZXJ2aWNlSXRlbSA9IGUudGFyZ2V0LnBhcmVudE5vZGU7XHJcbiAgICAgICAgICAgIHZhciBzZXJ2aWNlSXRlbVRleHQgPSBzZXJ2aWNlSXRlbS5xdWVyeVNlbGVjdG9yKCcuc2VydmljZXNfX3RleHQnKS5pbm5lckhUTUw7XHJcbiAgICAgICAgICAgIHZhciBzZXJ2aWNlSXRlbVRpdGxlID0gc2VydmljZUl0ZW0ucXVlcnlTZWxlY3RvcignLnNlcnZpY2VzX190aXRsZScpLmlubmVySFRNTDtcclxuXHJcbiAgICAgICAgICAgIG1vZGFsV2luZG93LnF1ZXJ5U2VsZWN0b3IoJy5tb3JlLW1vZGFsX190ZXh0JykuaW5uZXJIVE1MID0gc2VydmljZUl0ZW1UZXh0O1xyXG4gICAgICAgICAgICBtb2RhbFdpbmRvdy5xdWVyeVNlbGVjdG9yKCcubW9yZS1tb2RhbF9fdGl0bGUnKS5pbm5lckhUTUwgPSBzZXJ2aWNlSXRlbVRpdGxlO1xyXG5cclxuICAgICAgICAgICAgbW9kYWxXaW5kb3cuY2xhc3NMaXN0LmFkZCgndmlzaWJsZScpO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGluaXQoKSB7XHJcbiAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtb3JlQnV0dG9ucy5sZW5ndGg7IGkrKyApIHtcclxuICAgICAgICAgICAgICAgbW9yZUJ1dHRvbnNbaV0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHNob3dGdWxsVGV4dClcclxuICAgICAgICAgICB9XHJcbiAgICAgICAgfSAgXHJcbiAgICAgICAgdmFyIHRva2VuID0gUHViU3ViLnN1YnNjcmliZSggJ2luaXQnLCBpbml0ICk7XHJcbiAgICB9KSgpOyIsInZhciBTbGlkZXIgPSBmdW5jdGlvbihzbGlkZXJDbGFzcykge1xyXG5cclxuXHQndXNlIHN0cmljdCdcclxuXHJcblx0dmFyIGN1cnJlbnRTbGlkZSA9IDA7XHJcblx0dmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuXHR0aGlzLnNsaWRlclNob3cgXHRcdFx0PSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNsaWRlckNsYXNzKTtcclxuXHR0aGlzLnNsaWRlclNob3dJdGVtcyAgPSB0aGlzLnNsaWRlclNob3cucXVlcnlTZWxlY3RvckFsbCgnLnNsaWRlci1zaG93X19pdGVtJyk7XHJcblx0dGhpcy5hcnJvd0xlZnQgICAgICAgID0gdGhpcy5zbGlkZXJTaG93LnF1ZXJ5U2VsZWN0b3IoJy5hcnJvdy1sZWZ0Jyk7XHJcblx0dGhpcy5hcnJvd1JpZ2h0ICAgICAgID0gdGhpcy5zbGlkZXJTaG93LnF1ZXJ5U2VsZWN0b3IoJy5hcnJvdy1yaWdodCcpO1xyXG5cdHRoaXMucGFnaW5hdGlvbiAgICAgICA9IHRoaXMuc2xpZGVyU2hvdy5xdWVyeVNlbGVjdG9yKCcuc2xpZGVyLXNob3dfX3BhZ2luYXRpb24nKTtcclxuXHR0aGlzLnBhZ2luYXRpb25JdGVtc1x0PSBbXTtcclxuXHJcbiAgdGhpcy5jcmVhdGVQYWdpbmF0aW9uID0gZnVuY3Rpb24oc2xpZGVyTmFtZSkge1xyXG4gICAgICAgIFxyXG4gICAgLy8g0J/QvtGB0YfQuNGC0LDRgtGMINC60L7Qu9C40YfQtdGB0YLQstC+INGB0LvQsNC50LTQvtCyINCyINGB0LvQsNC50LTQtdGA0LVcclxuICAgIHZhciBzbGlkZXJFbGVtZW50c0NvdW50ICAgPSB0aGlzLnNsaWRlclNob3dJdGVtcy5sZW5ndGgsXHJcbiAgICAgICAgZnJhZ21lbnRPZlBhZ2luYXRpb25zID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLFxyXG4gICAgICAgIHBhZ2luYXRpb25JdGVtOyAgXHJcbiAgICAvLyDQodC+0LfQtNCw0YLRjCDRgdC+0L7RgtCy0LXRgtGB0YLQstGD0Y7RidC10LUg0LrQvtC70LjRh9C10YHRgtCy0L4g0Y3Qu9C10LzQtdC90YLQvtCyINC/0LDQs9C40L3QsNGG0LjQuFxyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNsaWRlckVsZW1lbnRzQ291bnQ7IGkrKykge1xyXG4gICAgICAgICAgcGFnaW5hdGlvbkl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgIHBhZ2luYXRpb25JdGVtLmNsYXNzTmFtZSA9IFwic2xpZGVyLXNob3dfX3BhZ2luYXRpb24taXRlbVwiO1xyXG4gICAgICAgICAgaWYgKGkgPT0gMCkge1xyXG4gICAgICAgICAgICBwYWdpbmF0aW9uSXRlbS5jbGFzc0xpc3QuYWRkKCdzbGlkZXItc2hvd19fcGFnaW5hdGlvbi1pdGVtLS1hY3RpdmUnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGZyYWdtZW50T2ZQYWdpbmF0aW9ucy5hcHBlbmRDaGlsZChwYWdpbmF0aW9uSXRlbSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAvLyDQlNC+0LHQsNCy0LjRgtGMINC/0LDQs9C40L3QsNGG0LjRjiDQuiDRgdC70LDQudC00LXRgNGDXHJcbiAgICAgICAgdGhpcy5wYWdpbmF0aW9uLmlubmVySFRNTCA9ICcnO1xyXG4gICAgICAgIHRoaXMucGFnaW5hdGlvbi5hcHBlbmRDaGlsZChmcmFnbWVudE9mUGFnaW5hdGlvbnMpOyBcclxuICAgICAgfSBcclxuICAgICAgICAgICAgXHJcbiAgICB0aGlzLmNsaWNrUGFnaW5hdGlvbiA9IGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0XHRzZWxmLnJlc2V0KCk7XHJcbiAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmFkZCgncGFnZS1wYWdpbmF0aW9uX19pdGVtLS1hY3RpdmUnKTtcclxuICAgICAgICBmb3IodmFyIGogPSAwOyBqIDwgc2VsZi5wYWdpbnRvbkl0ZW1zLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICBpZihzZWxmLnBhZ2ludG9uSXRlbXNbal0gPT0gZS50YXJnZXQpIGN1cnJlbnRTbGlkZSAgPSBqO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRzZWxmLnNsaWRlclNob3dJdGVtc1tjdXJyZW50U2xpZGVdLmNsYXNzTGlzdC5hZGQoJ3NsaWRlcl9faXRlbV9hY3RpdmUnKTtcclxuICAgICAgICBzZWxmLnBhZ2ludG9uSXRlbXNbY3VycmVudFNsaWRlXS5jbGFzc0xpc3QuYWRkKCdzbGlkZXItc2hvd19fcGFnaW5hdGlvbi1pdGVtLS1hY3RpdmUnKTtcclxuICAgICAgfVxyXG4gICAgXHJcbiAgICB0aGlzLnJlc2V0ID0gZnVuY3Rpb24oKXtcclxuICAgICAgICBmb3IodmFyIGkgPSAwLCBtYXggPSB0aGlzLnNsaWRlclNob3dJdGVtcy5sZW5ndGggOyBpIDwgbWF4IDsgaSsrKSB7XHJcbiAgICAgICAgICB0aGlzLnNsaWRlclNob3dJdGVtc1tpXS5jbGFzc0xpc3QucmVtb3ZlKCdzbGlkZXJfX2l0ZW1fYWN0aXZlJyk7XHJcbiAgICAgICAgICB0aGlzLnBhZ2ludG9uSXRlbXNbaV0uY2xhc3NMaXN0LnJlbW92ZSgnc2xpZGVyLXNob3dfX3BhZ2luYXRpb24taXRlbS0tYWN0aXZlJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICBcclxuICAgIHRoaXMuc3RhcnRTbGlkZSA9IGZ1bmN0aW9uKGN1cnJlbnRTbGlkZSkge1xyXG5cdFx0XHRcdHRoaXMuY3JlYXRlUGFnaW5hdGlvbihzbGlkZXJDbGFzcyk7XHJcblx0XHRcdFx0dGhpcy5wYWdpbnRvbkl0ZW1zID0gdGhpcy5wYWdpbmF0aW9uLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zbGlkZXItc2hvd19fcGFnaW5hdGlvbi1pdGVtJyk7XHJcbiAgICAgICAgdGhpcy5yZXNldCgpO1xyXG4gICAgICAgIHRoaXMuc2xpZGVyU2hvd0l0ZW1zW2N1cnJlbnRTbGlkZV0uY2xhc3NMaXN0LmFkZCgnc2xpZGVyX19pdGVtX2FjdGl2ZScpO1xyXG5cdFx0XHRcdHRoaXMucGFnaW50b25JdGVtc1tjdXJyZW50U2xpZGVdLmNsYXNzTGlzdC5hZGQoJ3NsaWRlci1zaG93X19wYWdpbmF0aW9uLWl0ZW0tLWFjdGl2ZScpO1xyXG5cdFx0XHRcdHRoaXMuaW5pdCgpO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgdGhpcy5zbGlkZUxlZnQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLnJlc2V0KCk7XHJcbiAgICAgICAgdGhpcy5zbGlkZXJTaG93SXRlbXNbY3VycmVudFNsaWRlLTFdLmNsYXNzTGlzdC5hZGQoJ3NsaWRlcl9faXRlbV9hY3RpdmUnKTtcclxuICAgICAgICB0aGlzLnBhZ2ludG9uSXRlbXNbY3VycmVudFNsaWRlLTFdLmNsYXNzTGlzdC5hZGQoJ3NsaWRlci1zaG93X19wYWdpbmF0aW9uLWl0ZW0tLWFjdGl2ZScpO1xyXG4gICAgICAgIGN1cnJlbnRTbGlkZSAtLTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgdGhpcy5zbGlkZVJpZ2h0ID0gZnVuY3Rpb24oKSB7IFxyXG4gICAgICAgIHRoaXMucmVzZXQoKTtcclxuICAgICAgICB0aGlzLnNsaWRlclNob3dJdGVtc1tjdXJyZW50U2xpZGUrMV0uY2xhc3NMaXN0LmFkZCgnc2xpZGVyX19pdGVtX2FjdGl2ZScpO1xyXG4gICAgICAgIHRoaXMucGFnaW50b25JdGVtc1tjdXJyZW50U2xpZGUrMV0uY2xhc3NMaXN0LmFkZCgnc2xpZGVyLXNob3dfX3BhZ2luYXRpb24taXRlbS0tYWN0aXZlJyk7XHJcbiAgICAgICAgY3VycmVudFNsaWRlICsrO1xyXG4gICAgICB9XHJcbiAgICBcclxuICAgIFxyXG4gICAgdGhpcy5pbml0ID0gZnVuY3Rpb24oKSB7XHJcbiBcdFx0XHQvLyDQlNC+0LHQsNCy0LvRj9C10Lwg0L7QsdGA0LDQsdC+0YLRh9C40LrQuCDRgdC+0LHRi9GC0LjQuSDQtNC70Y8g0YHQu9Cw0LnQtNC10YDQsFxyXG4gICAgICBmb3IgKHZhciBpID0gMCwgbWF4ID0gdGhpcy5wYWdpbnRvbkl0ZW1zLmxlbmd0aDsgaSA8IG1heDsgaSsrKSB7XHJcbiAgICAgICAgdGhpcy5wYWdpbnRvbkl0ZW1zW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbGlja1BhZ2luYXRpb24pO1xyXG4gICAgICB9XHJcbiAgICBcclxuICAgICAgdGhpcy5hcnJvd0xlZnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZihjdXJyZW50U2xpZGUgPT09IDApe1xyXG4gICAgICAgICAgY3VycmVudFNsaWRlID0gc2VsZi5zbGlkZXJTaG93SXRlbXMubGVuZ3RoO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzZWxmLnNsaWRlTGVmdCgpO1xyXG4gICAgICB9KVxyXG4gICAgICBcclxuICAgICAgdGhpcy5hcnJvd1JpZ2h0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYoY3VycmVudFNsaWRlID09PSBzZWxmLnNsaWRlclNob3dJdGVtcy5sZW5ndGggLSAxKXtcclxuICAgICAgICAgIGN1cnJlbnRTbGlkZSA9IC0xO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzZWxmLnNsaWRlUmlnaHQoKTtcclxuICAgICAgfSlcclxuICAgIH1cclxufTsiLCJ2YXIgc2xpZGVyRm9yUG9ydGZvbGlvID0gKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnXHJcblxyXG4gICAgdmFyIHNsaWRlciA9IG51bGwsXHJcbiAgICAgICAgcG9ydGZvbGlvSXRlbXMgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9ydGZvbGlvX19pdGVtJyksXHJcbiAgICAgICAgcG9ydGZvbGlvQnV0dG9ucyAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcub3Blbi1zbGlkZXInKSxcclxuICAgICAgICBwb3J0Zm9saW9JdENvdW50ICA9IHBvcnRmb2xpb0l0ZW1zLmxlbmd0aCxcclxuICAgICAgICBzbGlkZXJXaW5kb3cgICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zaG93LXBob3Rvcy1tb2RhbCcpLFxyXG4gICAgICAgIHNsaWRlckZvclBob3RvICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNsaWRlci1zaG93LS1pbWcnKSxcclxuICAgICAgICBwYWdpbmF0aW9uICAgICAgICA9IHNsaWRlckZvclBob3RvLnF1ZXJ5U2VsZWN0b3IoJy5zbGlkZXItc2hvd19fcGFnaW5hdGlvbicpLFxyXG4gICAgXHQgIHNsaWRlclNob3dMaXN0ICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNsaWRlci1zaG93X19saXN0JyksXHJcbiAgICAgICAgYXJyb3dMZWZ0ICAgICAgICAgPSBzbGlkZXJGb3JQaG90by5xdWVyeVNlbGVjdG9yKCcuYXJyb3ctbGVmdCcpLFxyXG4gICAgICAgIGFycm93UmlnaHQgICAgICAgID0gc2xpZGVyRm9yUGhvdG8ucXVlcnlTZWxlY3RvcignLmFycm93LXJpZ2h0Jyk7XHJcblxyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb3J0Zm9saW9JdGVtcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBwb3J0Zm9saW9JdGVtc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGdldEltYWdlcyk7XHJcbiAgICAgIHBvcnRmb2xpb0J1dHRvbnNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBnZXRJbWFnZXMpO1xyXG4gICAgfSAgXHJcbiAgICBcclxuICAgIGZ1bmN0aW9uIGdldEltYWdlcyhlKSB7XHJcblxyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHZhciBpbWFnZXMgPSB0aGlzLmRhdGFzZXQuaW1nLFxyXG4gICAgICBzbGlkZSxcclxuICAgICAgZnJhZ21lbnRPZlNsaWRlcztcclxuXHJcbiAgICAgIC8vINCV0YHQu9C4INC90LXRgiDRhNC+0YLQvtCz0YDQsNGE0LjQuSDQtNC70Y8g0L7QsdGK0LXQutGC0LAsINCy0YvQstC+0LTQuNC8INGB0L7QvtCx0YnQtdC90LjQtSDQvtCxINGN0YLQvtC8XHJcbiAgICAgIGlmKCFpbWFnZXMpIHtcclxuICAgICAgICBhcnJvd0xlZnQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgICAgIGFycm93UmlnaHQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG5cclxuICAgICAgICBwYWdpbmF0aW9uLmlubmVySFRNTCA9ICcnO1xyXG4gICAgICAgIHNsaWRlclNob3dMaXN0LmlubmVySFRNTCA9ICcnO1xyXG4gICAgICAgIHNsaWRlclNob3dMaXN0LmlubmVySFRNTCA9ICc8cCBzdHlsZSA9IFwibWFyZ2luOiBhdXRvO1wiPtCd0LXRgiDQuNC90YTQvtGA0LzQsNGG0LjQuCDQv9C+INC00LDQvdC90L7QvNGDINC+0LHRitC10LrRgtGDPC9wPic7XHJcblxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGFycm93TGVmdC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gICAgICAgIGFycm93UmlnaHQuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuXHJcbiAgICAgICAgaW1hZ2VzID0gaW1hZ2VzLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgZnJhZ21lbnRPZlNsaWRlcyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcclxuXHJcbiAgICAgIC8vINC30LDQv9C+0LvQvdGP0LXRgiDRgdC70LDQudC00LXRgCDQutCw0YDRgtC40L3QutCw0LzQuCDQuCDQtNC+0LHQsNCy0LvQtdC8INC/0LDQs9C40L3QsNGG0LjRjlxyXG4gICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGltYWdlcy5sZW5ndGg7IGorKykge1xyXG5cclxuICAgICAgICBzbGlkZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgICAgICAgc2xpZGUuaW5uZXJIVE1MID0gJzxkaXYgY2xhc3MgPSBcInNsaWRlci1zaG93X19jb250ZW50XCI+PGltZyBzcmMgPSBcImFzc2V0cy9pbWcvJytpbWFnZXNbal0rJ1wiPjwvZGl2PidcclxuICAgICAgICBzbGlkZS5jbGFzc05hbWUgPSBcInNsaWRlci1zaG93X19pdGVtXCI7XHJcbiAgICAgICAgZnJhZ21lbnRPZlNsaWRlcy5hcHBlbmRDaGlsZChzbGlkZSk7XHJcbiAgICB9XHJcblxyXG4gIHNsaWRlclNob3dMaXN0LmlubmVySFRNTCA9ICcnO1xyXG4gIHNsaWRlclNob3dMaXN0LmFwcGVuZENoaWxkKGZyYWdtZW50T2ZTbGlkZXMpO1xyXG4gIFxyXG5cclxuICAvLyDQl9Cw0L/Rg9GB0YLQuNGC0Ywg0YHQu9Cw0LnQtNC10YBcclxuICAvL1B1YlN1Yi5wdWJsaXNoKCAnb3BlblNsaWRlcicsICcuc2xpZGVyLXNob3ctLWltZycpO1xyXG4gIHZhciBzbGlkZXIgPSBuZXcgU2xpZGVyKCcuc2xpZGVyLXNob3ctLWltZycpO1xyXG4gIHNsaWRlci5zdGFydFNsaWRlKDApO1xyXG59XHJcblxyXG4vL9Ce0YLQutGA0YvRgtGMINC+0LrQvdC+INGB0L4g0YHQu9Cw0LnQtNC10YDQvtC8XHJcbnNsaWRlcldpbmRvdy5jbGFzc0xpc3QuYWRkKCd2aXNpYmxlJyk7XHJcblxyXG59XHJcbn0pKCk7IiwidmFyIHJld2lld1NsaWRlciA9IChmdW5jdGlvbigpIHtcclxuXHJcbiAgICB2YXIgc2xpZGVyID0gbmV3IFNsaWRlcignLnNsaWRlci1zaG93X3JldycpO1xyXG4gICAgc2xpZGVyLnN0YXJ0U2xpZGUoMCk7XHJcbiAgICBcclxufSkoKSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
